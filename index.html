<!DOCTYPE html>
<html>
<head>
    <title>MemePet</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { font-family: Arial; padding: 20px; }
        .pet { max-width: 200px; }
        button { padding: 10px; margin: 5px; }
    </style>
</head>
<body>
    <h2>üêæ –í–∞—à –ø–∏—Ç–æ–º–µ—Ü</h2>
    <div id="petView"></div>
    
    <h3>ü•ö –Ø–π—Ü–∞: <span id="eggsCount">0</span></h3>
    <button onclick="openEgg()">–û—Ç–∫—Ä—ã—Ç—å —è–π—Ü–æ</button>

    <h3>–î–µ–π—Å—Ç–≤–∏—è</h3>
    <button onclick="feedPet()">–ü–æ–∫–æ—Ä–º–∏—Ç—å</button>

    <script>
    const tg = Telegram.WebApp;
    let userData = null;

    // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
    function loadData() {
        tg.sendData(JSON.stringify({ action: "get_data" }));
    }

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    tg.onEvent('web_app_data_received', (event) => {
        const data = JSON.parse(event.data);
        userData = data;
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
        if (data.pets && data.pets.length > 0) {
            renderPet(data.pets[0]);
        }
        document.getElementById("eggsCount").textContent = data.eggs || 0;
    });

    // –û—Ç–∫—Ä—ã—Ç–∏–µ —è–π—Ü–∞
    function openEgg() {
        tg.sendData(JSON.stringify({ action: "open_egg" }));
        tg.close();
    }

    // –ü–æ–∫–æ—Ä–º–∏—Ç—å
    function feedPet() {
        tg.sendData(JSON.stringify({ action: "feed" }));
    }

    // –†–µ–Ω–¥–µ—Ä –ø–∏—Ç–æ–º—Ü–∞
    function renderPet(pet) {
        const petView = document.getElementById("petView");
        if (pet) {
            petView.innerHTML = 
                <img src="${pet.image}" class="pet">
                <p>${pet.name} (–£—Ä. ${pet.level})</p>
                <p>üçñ –ì–æ–ª–æ–¥: ${pet.hunger}%</p>
            ;
        } else {
            petView.innerHTML = "<p>–£ –≤–∞—Å –Ω–µ—Ç –ø–∏—Ç–æ–º—Ü–µ–≤ üò¢</p>";
        }
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    tg.ready();
    tg.expand();
    loadData();
</script>
</body>
</html>
