<!DOCTYPE html>
<html>
<head>
    <title>MemePet</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* Добавлены новые анимации */
        .pulse {
            animation: pulse 1s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>
    <!-- Остальная разметка без изменений -->

    <script>
        const tg = Telegram.WebApp;
        let isActionLoading = false;

        // Улучшенная функция получения данных
        async function fetchData() {
            try {
                const response = await tg.sendData(JSON.stringify({
                    action: "get_data",
                    userId: tg.initDataUnsafe.user?.id
                }));
                
                if (!response.ok) throw new Error('Network error');
                const data = await response.json();
                
                if (data.error) throw new Error(data.error);
                updateUI(data);
                
            } catch (error) {
                showError(error.message);
            }
        }

        // Улучшенная обработка действий
        async function performAction(action) {
            if (isActionLoading) return;
            isActionLoading = true;
            
            try {
                tg.showPopup({ message: "⏳ Выполняем действие..." });
                const response = await fetch('YOUR_BACKEND_URL', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Telegram-Init-Data': Telegram.WebApp.initData
                    },
                    body: JSON.stringify({
                        action,
                        userId: tg.initDataUnsafe.user?.id
                    })
                });

                if (!response.ok) throw new Error('Ошибка сервера');
                const result = await response.json();
                
                if (result.error) throw new Error(result.error);
                updateUI(result.data);
                
            } catch (error) {
                showError(error.message);
            } finally {
                isActionLoading = false;
            }
        }

        // Добавлена валидация данных
        function validatePetData(pet) {
            return pet && 
                   typeof pet.name === 'string' &&
                   typeof pet.image === 'string' &&
                   typeof pet.hunger === 'number';
        }

        // Остальные функции с улучшениями...
    </script>
</body>
</html>
